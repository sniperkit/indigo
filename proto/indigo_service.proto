syntax = "proto3";

package proto;

service Indigo {
    rpc CreateIndex(CreateIndexRequest) returns (CreateIndexResponse) {}
    rpc OpenIndex(OpenIndexRequest) returns (OpenIndexResponse) {}
    rpc GetIndex(GetIndexRequest) returns (GetIndexResponse) {}
    rpc CloseIndex(CloseIndexRequest) returns (CloseIndexResponse) {}
    rpc DeleteIndex(DeleteIndexRequest) returns (DeleteIndexResponse) {}
    rpc ListIndex(ListIndexRequest) returns (ListIndexResponse) {}
    rpc PutDocument(PutDocumentRequest) returns (PutDocumentResponse) {}
    rpc GetDocument(GetDocumentRequest) returns (GetDocumentResponse) {}
    rpc DeleteDocument(DeleteDocumentRequest) returns (DeleteDocumentResponse) {}
    rpc Bulk(BulkRequest) returns (BulkResponse) {}
    rpc Search(SearchRequest) returns (SearchResponse) {}
}

message CreateIndexRequest {
    string index_name = 1;
    bytes index_mapping = 2;
    string index_type = 3;
    string kvstore = 4;
    bytes kvconfig = 5;
}

message CreateIndexResponse {
    string index_name = 1;
    string index_dir = 2;
}

message OpenIndexRequest {
    string index_name = 1;
    bytes runtime_config = 2;
}

message OpenIndexResponse {
    string index_name = 1;
    string index_dir = 2;
}

message GetIndexRequest {
    string index_name = 1;
}

message GetIndexResponse {
    uint64 document_count = 1;
    bytes index_stats = 2;
    bytes index_mapping = 3;
}

message CloseIndexRequest {
    string index_name = 1;
}

message CloseIndexResponse {
    string index_name = 1;
}

message DeleteIndexRequest {
    string index_name = 1;
}

message DeleteIndexResponse {
    string index_name = 1;
}

message ListIndexRequest {
}

message ListIndexResponse {
    repeated string indices = 1;
}

message PutDocumentRequest {
    string index_name = 1;
    string id = 2;
    bytes fields = 3;
}

message PutDocumentResponse {
    bool success = 1;
}

message GetDocumentRequest {
    string index_name = 1;
    string id = 2;
}

message GetDocumentResponse {
    string id = 1;
    bytes fields = 2;
}

message DeleteDocumentRequest {
    string index_name = 1;
    string id = 2;
}

message DeleteDocumentResponse {
    bool success = 1;
}

message BulkRequest {
    string index_name = 1;
    bytes bulk_request = 2;
    int32 batch_size = 3;
}

message BulkResponse {
    int32 put_count = 1;
    int32 put_error_count = 2;
    int32 delete_count = 3;
}

message SearchRequest {
    string index_name = 1;
    bytes search_request = 2;
}

message SearchResponse {
    bytes search_result = 1;
}
